{% extends 'Timesheet/base.html' %}
{% block title %}View Timesheet{% endblock %}
{% block content %}
  <h4>Timesheet for week of {{ timesheet.week_start }}</h4>
  <p>Submitted by {{ timesheet.owner.username }} on {{ timesheet.created_at }}</p>
  {% if editable %}
    <p><a class="btn btn-sm btn-outline-secondary" href="{% url 'Timesheet:edit_timesheet' timesheet.id %}">Edit Timesheet</a></p>
  {% endif %}

  {% if is_admin %}
    <form method="post" class="d-inline">
      {% csrf_token %}
      <button name="delete_timesheet" class="btn btn-sm btn-danger" onclick="return confirm('Delete this timesheet? This cannot be undone.')">Delete Timesheet</button>
    </form>
  {% endif %}

  {% if timesheet.rows.count %}
    <table class="table table-bordered table-sm">
      <thead>
        <tr>
          <th>Employee</th>
          <th>Mon</th>
          <th>Tues</th>
          <th>Wed</th>
          <th>Thur</th>
          <th>Fri</th>
          <th>Sat</th>
          <th>Sun</th>
          <th>Job Site Names</th>
          <th>Job Site Numbers</th>
        </tr>
      </thead>
      <tbody>
        {% for row in timesheet.rows.all %}
          <tr>
            <td>{{ row.employee_name }}{% if row.employee %}{% endif %}</td>
            <td>{{ row.mon }}</td>
            <td>{{ row.tues }}</td>
            <td>{{ row.wed }}</td>
            <td>{{ row.thur }}</td>
            <td>{{ row.fri }}</td>
            <td>{{ row.sat }}</td>
            <td>{{ row.sun }}</td>
            <td>{{ row.jobsite_name }}</td>
            <td>{{ row.jobsite_num }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p class="text-muted">No parsed data available. File stored at: {{ timesheet.file.url }}</p>
  {% endif %}
  {% if timesheet.additional_notes %}
    <div class="mb-3">
      <h5>Additional Notes</h5>
      <div class="border p-2 bg-white">{{ timesheet.additional_notes|linebreaksbr }}</div>
    </div>
  {% endif %}

{% endblock %}
